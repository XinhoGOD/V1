<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Favoritos de la Semana - NFL Fantasy Trends</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2.39.3/dist/umd/supabase.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <h1><i class="fas fa-star"></i> Favoritos de la Semana - Tendencias Positivas</h1>
                <div class="header-controls">
                    <div class="favoritos-stats">
                        <div class="stat-bubble">
                            <span class="stat-number" id="totalFavoritos">0</span>
                            <span class="stat-text">Favoritos</span>
                        </div>
                        <div class="stat-bubble">
                            <span class="stat-number" id="avgIncrease">0%</span>
                            <span class="stat-text">Promedio</span>
                        </div>
                    </div>
                    <button id="refreshFavoritos" class="btn-refresh">
                        <i class="fas fa-sync-alt"></i> Actualizar
                    </button>
                </div>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-content">
                <!-- Navigation Menu -->
                <nav class="sidebar-nav">
                    <h3><i class="fas fa-bars"></i> Navegaci√≥n</h3>
                    <ul class="nav-menu">
                        <li>
                            <a href="dashboard.html" class="nav-item">
                                <i class="fas fa-tachometer-alt"></i>
                                <span>Dashboard</span>
                            </a>
                        </li>
                        <li>
                            <a href="index.html" class="nav-item">
                                <i class="fas fa-users"></i>
                                <span>Jugadores</span>
                            </a>
                        </li>
                        <li>
                            <a href="sleepers.html" class="nav-item">
                                <i class="fas fa-eye"></i>
                                <span>Sleepers</span>
                            </a>
                        </li>
                        <li>
                            <a href="trends.html" class="nav-item">
                                <i class="fas fa-trending-up"></i>
                                <span>Tendencias</span>
                            </a>
                        </li>
                        <li>
                            <a href="fantasy-alert.html" class="nav-item">
                                <i class="fas fa-bell"></i>
                                <span>Fantasy Alert</span>
                            </a>
                        </li>
                        <li>
                            <a href="encuentros.html" class="nav-item">
                                <i class="fas fa-football-ball"></i>
                                <span>Encuentros</span>
                            </a>
                        </li>
                        <li>
                            <a href="favoritos.html" class="nav-item active">
                                <i class="fas fa-star"></i>
                                <span>Favoritos Semana</span>
                            </a>
                        </li>
                        <li>
                            <a href="settings.html" class="nav-item">
                                <i class="fas fa-cog"></i>
                                <span>Configuraci√≥n</span>
                            </a>
                        </li>
                    </ul>
                </nav>

                <!-- Favoritos Filters -->
                <div class="filters-section">
                    <h3><i class="fas fa-filter"></i> Filtros Favoritos</h3>
                    
                    <div class="filter-group">
                        <label for="positionFilterFavoritos">Posici√≥n:</label>
                        <select id="positionFilterFavoritos" class="filter-select">
                            <option value="">Todas las posiciones</option>
                            <option value="QB">QB</option>
                            <option value="RB">RB</option>
                            <option value="WR">WR</option>
                            <option value="TE">TE</option>
                            <option value="K">K</option>
                            <option value="DEF">DEF</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="teamFilterFavoritos">Equipo:</label>
                        <select id="teamFilterFavoritos" class="filter-select">
                            <option value="">Todos los equipos</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label for="minStartedIncrease">Min Aumento Started:</label>
                        <input type="range" id="minStartedIncrease" min="0.1" max="50" value="0.1" step="0.1" class="filter-range">
                        <span id="minStartedIncreaseValue" class="range-value">0.1%</span>
                    </div>

                    <div class="filter-group">
                        <label for="minCurrentStarted">Min % Started Actual:</label>
                        <input type="range" id="minCurrentStarted" min="0" max="100" value="0" class="filter-range">
                        <span id="minCurrentStartedValue" class="range-value">0%</span>
                    </div>

                    <div class="filter-group">
                        <label for="minRosteredFavoritos">Min % Rostered:</label>
                        <input type="range" id="minRosteredFavoritos" min="0" max="100" value="0" class="filter-range">
                        <span id="minRosteredFavoritosValue" class="range-value">0%</span>
                    </div>
                </div>

                <!-- Top Performers Summary -->
                <div class="stats-summary">
                    <h3><i class="fas fa-trophy"></i> Top Performers</h3>
                    <div class="stats-container">
                        <div class="stat-item top-performer">
                            <span class="stat-label">ü•á Mayor Aumento:</span>
                            <div class="stat-value-container">
                                <span id="topPlayerName" class="stat-value">-</span>
                                <span id="topPlayerIncrease" class="stat-increase">-</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">üíé Mejor QB:</span>
                            <div class="stat-value-container">
                                <span id="topQBName" class="stat-value">-</span>
                                <span id="topQBIncrease" class="stat-increase">-</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">üèÉ Mejor RB:</span>
                            <div class="stat-value-container">
                                <span id="topRBName" class="stat-value">-</span>
                                <span id="topRBIncrease" class="stat-increase">-</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">‚ö° Mejor WR:</span>
                            <div class="stat-value-container">
                                <span id="topWRName" class="stat-value">-</span>
                                <span id="topWRIncrease" class="stat-increase">-</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">üéØ Mejor TE:</span>
                            <div class="stat-value-container">
                                <span id="topTEName" class="stat-value">-</span>
                                <span id="topTEIncrease" class="stat-increase">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Loading Indicator -->
            <div id="loadingFavoritos" class="loading-container">
                <div class="loading-spinner"></div>
                <p>Analizando favoritos de la semana...</p>
            </div>

            <!-- Favoritos Content -->
            <div id="favoritosContent" class="favoritos-content" style="display: none;">
                <!-- Favoritos Header -->
                <div class="favoritos-header">
                    <div class="header-info">
                        <h2><i class="fas fa-chart-line"></i> Jugadores con Tendencia Ascendente</h2>
                        <p>Jugadores ordenados por mayor aumento en % Started de la semana</p>
                    </div>
                    <div class="favoritos-metrics">
                        <div class="metric-card favoritos-metric success-metric">
                            <div class="metric-icon">
                                <i class="fas fa-arrow-up"></i>
                            </div>
                            <div class="metric-content">
                                <h3>Mayor Aumento</h3>
                                <div class="metric-value" id="maxIncreaseValue">-</div>
                                <div class="metric-change" id="maxIncreasePlayer">-</div>
                            </div>
                        </div>

                        <div class="metric-card favoritos-metric info-metric">
                            <div class="metric-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="metric-content">
                                <h3>Total Favoritos</h3>
                                <div class="metric-value" id="totalFavoritosMetric">0</div>
                                <div class="metric-change">Jugadores en ascenso</div>
                            </div>
                        </div>

                        <div class="metric-card favoritos-metric warning-metric">
                            <div class="metric-icon">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                            <div class="metric-content">
                                <h3>Promedio Aumento</h3>
                                <div class="metric-value" id="avgIncreaseMetric">-</div>
                                <div class="metric-change">Crecimiento medio</div>
                            </div>
                        </div>

                        <div class="metric-card favoritos-metric elite-metric">
                            <div class="metric-icon">
                                <i class="fas fa-fire"></i>
                            </div>
                            <div class="metric-content">
                                <h3>Tendencias Calientes</h3>
                                <div class="metric-value" id="hotTrendsCount">0</div>
                                <div class="metric-change">Aumentos >5%</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Favoritos Chart -->
                <div class="favoritos-chart-section">
                    <div class="chart-container">
                        <h3><i class="fas fa-chart-area"></i> Top Performers</h3>
                        
                        <!-- Top Performers Stats -->
                        <div class="top-performers-display" style="
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                            gap: 12px;
                            margin: 16px 0;
                            padding: 16px;
                            background: rgba(255, 255, 255, 0.1);
                            border-radius: 12px;
                            backdrop-filter: blur(10px);
                        ">
                            <div class="performer-stat" style="
                                padding: 12px;
                                background: rgba(255, 255, 255, 0.2);
                                border-radius: 8px;
                                text-align: center;
                            ">
                                <div style="font-size: 14px; margin-bottom: 4px;">ü•á Mayor Aumento</div>
                                <div id="topPlayerNameChart" style="font-weight: bold; font-size: 16px;">-</div>
                                <div id="topPlayerIncreaseChart" style="color: #059669; font-weight: 600; font-size: 14px;">-</div>
                            </div>
                            <div class="performer-stat" style="
                                padding: 12px;
                                background: rgba(255, 255, 255, 0.2);
                                border-radius: 8px;
                                text-align: center;
                            ">
                                <div style="font-size: 14px; margin-bottom: 4px;">üíé Mejor QB</div>
                                <div id="topQBNameChart" style="font-weight: bold; font-size: 16px;">-</div>
                                <div id="topQBIncreaseChart" style="color: #059669; font-weight: 600; font-size: 14px;">-</div>
                            </div>
                            <div class="performer-stat" style="
                                padding: 12px;
                                background: rgba(255, 255, 255, 0.2);
                                border-radius: 8px;
                                text-align: center;
                            ">
                                <div style="font-size: 14px; margin-bottom: 4px;">üèÉ Mejor RB</div>
                                <div id="topRBNameChart" style="font-weight: bold; font-size: 16px;">-</div>
                                <div id="topRBIncreaseChart" style="color: #059669; font-weight: 600; font-size: 14px;">-</div>
                            </div>
                            <div class="performer-stat" style="
                                padding: 12px;
                                background: rgba(255, 255, 255, 0.2);
                                border-radius: 8px;
                                text-align: center;
                            ">
                                <div style="font-size: 14px; margin-bottom: 4px;">‚ö° Mejor WR</div>
                                <div id="topWRNameChart" style="font-weight: bold; font-size: 16px;">-</div>
                                <div id="topWRIncreaseChart" style="color: #059669; font-weight: 600; font-size: 14px;">-</div>
                            </div>
                            <div class="performer-stat" style="
                                padding: 12px;
                                background: rgba(255, 255, 255, 0.2);
                                border-radius: 8px;
                                text-align: center;
                            ">
                                <div style="font-size: 14px; margin-bottom: 4px;">üéØ Mejor TE</div>
                                <div id="topTENameChart" style="font-weight: bold; font-size: 16px;">-</div>
                                <div id="topTEIncreaseChart" style="color: #059669; font-weight: 600; font-size: 14px;">-</div>
                            </div>
                        </div>
                        
                        <canvas id="favoritosChart"></canvas>
                    </div>
                </div>

                <!-- Favoritos Players List -->
                <div class="favoritos-players-section">
                    <div class="favoritos-players-header">
                        <h2><i class="fas fa-list-ol"></i> Lista Completa de Favoritos</h2>
                        <div class="sort-controls">
                            <label for="favoritosSortBy">Ordenar por:</label>
                            <select id="favoritosSortBy" class="sort-select">
                                <option value="percent_started_change">Aumento Started</option>
                                <option value="percent_started">% Started Actual</option>
                                <option value="percent_rostered">% Rostered</option>
                                <option value="player_name">Nombre</option>
                            </select>
                            <button id="favoritosSortOrder" class="btn-sort" data-order="desc">
                                <i class="fas fa-sort-amount-down"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div id="favoritosPlayersList" class="favoritos-players-list">
                        <!-- Players will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Player Detail Modal -->
            <div id="favoritosPlayerModal" class="modal">
                <div class="modal-content favoritos-modal-content">
                    <div class="modal-header favoritos-modal-header">
                        <div class="player-header-info">
                            <div class="player-avatar">
                                <i class="fas fa-user-circle"></i>
                            </div>
                            <div class="player-title-section">
                                <h2 id="favoritosModalPlayerName" class="player-name">Favorito - Detalles del Jugador</h2>
                                <div class="player-meta">
                                    <span id="favoritosModalPosition" class="position-badge"></span>
                                    <span id="favoritosModalTeam" class="team-badge"></span>
                                </div>
                            </div>
                        </div>
                        <div class="modal-actions">
                            <div id="favoritosModalRanking" class="ranking-crown">
                                <i class="fas fa-crown"></i>
                                <span>#1</span>
                            </div>
                            <span class="close">&times;</span>
                        </div>
                    </div>
                    
                    <div class="modal-body favoritos-modal-body">
                        <!-- Hero Stats Section -->
                        <div class="hero-stats-section">
                            <div class="hero-stat main-increase">
                                <div class="stat-icon">
                                    <i class="fas fa-rocket"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value" id="favoritosModalStartedChange">+15.2%</div>
                                    <div class="stat-label">Aumento Started</div>
                                    <div class="stat-sublabel">Esta Semana</div>
                                </div>
                                <div class="stat-trend">
                                    <i class="fas fa-arrow-up"></i>
                                </div>
                            </div>
                            
                            <div class="hero-stat current-performance">
                                <div class="stat-icon">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value" id="favoritosModalCurrentStarted">45.8%</div>
                                    <div class="stat-label">% Started Actual</div>
                                    <div class="stat-sublabel">Semana Actual</div>
                                </div>
                            </div>
                            
                            <div class="hero-stat roster-rate">
                                <div class="stat-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-content">
                                    <div class="stat-value" id="favoritosModalRostered">78.3%</div>
                                    <div class="stat-label">% Rostered</div>
                                    <div class="stat-sublabel">Total Ligas</div>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Comparison -->
                        <div class="quick-comparison">
                            <div class="comparison-item">
                                <span class="comparison-label">Semana Anterior:</span>
                                <span id="favoritosModalPreviousStarted" class="comparison-value previous">30.6%</span>
                            </div>
                            <div class="comparison-arrow">
                                <i class="fas fa-long-arrow-alt-right"></i>
                            </div>
                            <div class="comparison-item">
                                <span class="comparison-label">Semana Actual:</span>
                                <span class="comparison-value current">45.8%</span>
                            </div>
                        </div>

                        <!-- Enhanced Charts Grid -->
                        <div class="enhanced-charts-grid">
                            <div class="chart-card primary-chart">
                                <div class="chart-header">
                                    <div class="chart-title">
                                        <i class="fas fa-chart-area"></i>
                                        <span>Evoluci√≥n % Started</span>
                                    </div>
                                    <div class="chart-period">√öltimas 8 semanas</div>
                                </div>
                                <div class="chart-container">
                                    <canvas id="favoritosStartedChart"></canvas>
                                </div>
                                <div class="chart-insights">
                                    <div class="insight">
                                        <i class="fas fa-trending-up"></i>
                                        <span>Tendencia ascendente</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="chart-card secondary-chart">
                                <div class="chart-header">
                                    <div class="chart-title">
                                        <i class="fas fa-chart-bar"></i>
                                        <span>Cambios Semanales</span>
                                    </div>
                                    <div class="chart-period">Variaciones</div>
                                </div>
                                <div class="chart-container">
                                    <canvas id="favoritosStartedChangeChart"></canvas>
                                </div>
                            </div>
                            
                            <div class="chart-card comparison-chart">
                                <div class="chart-header">
                                    <div class="chart-title">
                                        <i class="fas fa-balance-scale"></i>
                                        <span>Rostered vs Started</span>
                                    </div>
                                    <div class="chart-period">Comparativa</div>
                                </div>
                                <div class="chart-container">
                                    <canvas id="favoritosComparisonChart"></canvas>
                                </div>
                            </div>
                            
                            <div class="chart-card activity-chart">
                                <div class="chart-header">
                                    <div class="chart-title">
                                        <i class="fas fa-exchange-alt"></i>
                                        <span>Actividad Waiver</span>
                                    </div>
                                    <div class="chart-period">Adds vs Drops</div>
                                </div>
                                <div class="chart-container">
                                    <canvas id="favoritosAddsDropsChart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Performance Insights -->
                        <div class="performance-insights">
                            <h4>
                                <i class="fas fa-lightbulb"></i>
                                Insights del Jugador
                            </h4>
                            <div class="insights-grid">
                                <div class="insight-card trending">
                                    <div class="insight-icon">
                                        <i class="fas fa-fire"></i>
                                    </div>
                                    <div class="insight-content">
                                        <div class="insight-title">En Racha</div>
                                        <div class="insight-description">Aument√≥ su % Started 3 semanas consecutivas</div>
                                    </div>
                                </div>
                                
                                <div class="insight-card waiver">
                                    <div class="insight-icon">
                                        <i class="fas fa-plus-circle"></i>
                                    </div>
                                    <div class="insight-content">
                                        <div class="insight-title">Alta Demanda</div>
                                        <div class="insight-description">M√°s adds que drops esta semana</div>
                                    </div>
                                </div>
                                
                                <div class="insight-card potential">
                                    <div class="insight-icon">
                                        <i class="fas fa-star"></i>
                                    </div>
                                    <div class="insight-content">
                                        <div class="insight-title">Alto Potencial</div>
                                        <div class="insight-description">Gap favorable entre rostered y started</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- AI Analysis Section -->
                        <div id="aiAnalysisSection">
                            <!-- El an√°lisis AI se insertar√° aqu√≠ din√°micamente -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Configuration Modal -->
    <div id="configModal" class="modal">
        <div class="modal-content config-modal">
            <div class="modal-header">
                <h2>Configuraci√≥n de Supabase</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form class="config-form" onsubmit="return false;">
                    <div class="form-group">
                        <label for="supabaseUrl">URL de Supabase:</label>
                        <input type="text" id="supabaseUrl" placeholder="https://tu-proyecto.supabase.co" class="config-input" autocomplete="url">
                    </div>
                    <div class="form-group">
                        <label for="supabaseKey">Anon Key de Supabase:</label>
                        <input type="password" id="supabaseKey" placeholder="Tu clave an√≥nima" class="config-input" autocomplete="current-password">
                    </div>
                    <div class="form-actions">
                        <button type="button" id="saveConfig" class="btn-primary">Guardar Configuraci√≥n</button>
                        <button type="button" id="testConnection" class="btn-secondary">Probar Conexi√≥n</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Configuration Button -->
    <button id="configBtn" class="config-btn" title="Configurar Supabase">
        <i class="fas fa-cog"></i>
    </button>

    <script src="favoritos.js"></script>
</body>
</html>
